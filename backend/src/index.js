const express = require('express'); // Express ν”„λ μ„μ›ν¬ λ¶λ¬μ¤κΈ°
const cors = require('cors'); // CORS λ―Έλ“¤μ›¨μ–΄ λ¶λ¬μ¤κΈ°

// Express μ•± μƒμ„±
const app = express(); // Express μ• ν”λ¦¬μΌ€μ΄μ… μΈμ¤ν„΄μ¤ μƒμ„±

// λ―Έλ“¤μ›¨μ–΄ μ„¤μ •
app.use(cors());              // ν”„λ΅ νΈμ—”λ“ μ—°κ²° ν—μ©
app.use(express.json());      // JSON νμ‹±

/* λ―Έλ“¤μ›¨μ–΄λ€? μ”μ²­κ³Ό μ‘λ‹µ μ‚¬μ΄μ—μ„ μ‹¤ν–‰λλ” ν•¨μ
ν΄λΌμ΄μ–ΈνΈ μ”μ²­ -> [λ―Έλ“¤μ›¨μ–΄1] -> [λ―Έλ“¤μ›¨μ–΄2] -> λΌμ°νΈ μ²λ¦¬ -> μ„λ²„ μ‘λ‹µ */

/* CORS λ―Έλ“¤μ›¨μ–΄λ€?
CORS(Cross-Origin Resource Sharing)λ” 
μ„λ΅ λ‹¤λ¥Έ λ„λ©”μΈ κ°„μ λ¦¬μ†μ¤ κ³µμ λ¥Ό ν—μ©ν•λ” λ©”μ»¤λ‹μ¦μ…λ‹λ‹¤. 
μλ¥Ό λ“¤μ–΄, ν”„λ΅ νΈμ—”λ“κ°€ http://localhost:3000μ—μ„ μ‹¤ν–‰λκ³  
λ°±μ—”λ“κ°€ http://localhost:3001μ—μ„ μ‹¤ν–‰λ  λ•,
λΈλΌμ°μ €λ” λ³΄μ•μƒμ μ΄μ λ΅ μ„λ΅ λ‹¤λ¥Έ μ¶μ² κ°„μ μ”μ²­μ„ μ ν•ν•©λ‹λ‹¤. 
CORS λ―Έλ“¤μ›¨μ–΄λ” μ΄λ¬ν• μ ν•μ„ μ°νν•μ—¬ 
ν”„λ΅ νΈμ—”λ“κ°€ λ°±μ—”λ“ APIμ— μ ‘κ·Όν•  μ μλ„λ΅ λ„μ™€μ¤λ‹λ‹¤. */

/* express.json() λ―Έλ“¤μ›¨μ–΄λ€?
μ΄ λ―Έλ“¤μ›¨μ–΄λ” λ“¤μ–΄μ¤λ” μ”μ²­μ λ³Έλ¬Έμ΄ JSON ν•μ‹μΌ λ• 
μ΄λ¥Ό μλ™μΌλ΅ νμ‹±ν•μ—¬ JavaScript κ°μ²΄λ΅ λ³€ν™ν•΄μ¤λ‹λ‹¤. 
λ”°λΌμ„, ν΄λΌμ΄μ–ΈνΈκ°€ JSON λ°μ΄ν„°λ¥Ό μ„λ²„λ΅ λ³΄λ‚Ό λ• 
req.bodyλ¥Ό ν†µν•΄ μ‰½κ² μ ‘κ·Όν•  μ μμµλ‹λ‹¤. */

// ===== API λΌμ°νΈ =====

// ν—¬μ¤ μ²΄ν¬ API
app.get('/api/health', (req, res) => {
  res.json({ 
    status: 'ok', 
    message: 'μ„λ²„κ°€ μ •μƒ μ‘λ™ μ¤‘μ…λ‹λ‹¤!',
    timestamp: new Date().toISOString()
  });
});

/*app.get('/api/health')λ” HTTP GET μ”μ²­μ„ μ²λ¦¬ν•λ” λΌμ°νΈ ν•Έλ“¤λ¬λ¥Ό μ •μν•©λ‹λ‹¤.
ν΄λΌμ΄μ–ΈνΈκ°€ /api/health μ—”λ“ν¬μΈνΈλ΅ GET μ”μ²­μ„ λ³΄λ‚΄λ©΄,
μ„λ²„λ” JSON ν•μ‹μ μ‘λ‹µμ„ λ°ν™ν•©λ‹λ‹¤. 
μ΄ μ‘λ‹µμ—λ” μ„λ²„ μƒνƒ(status), λ©”μ‹μ§€(message), 
κ·Έλ¦¬κ³  ν„μ¬ μ‹κ°„(timestamp)μ΄ ν¬ν•¨λμ–΄ μμµλ‹λ‹¤*/

// (req, res)λ” μ”μ²­(request)κ³Ό μ‘λ‹µ(response) κ°μ²΄λ¥Ό λ‚νƒ€λƒ…λ‹λ‹¤.
// req: ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„λ΅ λ³΄λ‚Έ μ”μ²­μ— λ€ν• μ •λ³΄κ°€ λ‹΄κΈ΄ κ°μ²΄
// res: μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈλ΅ λ³΄λ‚΄λ” μ‘λ‹µμ„ κµ¬μ„±ν•λ” κ°μ²΄

// ν…μ¤νΈ API
app.get('/api/test', (req, res) => {
  res.json({ 
    message: 'λ°±μ—”λ“μ™€ μ—°κ²° μ„±κ³µ!',
    data: {
      name: 'Game Automation Tool',
      version: '1.0.0'
    }
  });
});

// ===== μ„λ²„ μ‹μ‘ =====
const PORT = 3001;

app.listen(PORT, () => {
  console.log('========================================');
  console.log(`β… λ°±μ—”λ“ μ„λ²„ μ‹μ‘!`);
  console.log(`π“΅ http://localhost:${PORT}`);
  console.log(`π” ν—¬μ¤μ²΄ν¬: http://localhost:${PORT}/api/health`);
  console.log('========================================');
});